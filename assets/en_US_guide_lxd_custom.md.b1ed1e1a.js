import{_ as e,v as t,b as s,R as a}from"./chunks/framework.70afa331.js";const g=JSON.parse('{"title":"","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"en_US/guide/lxd_custom.md","filePath":"en_US/guide/lxd_custom.md","lastUpdated":1698079096000}'),n={name:"en_US/guide/lxd_custom.md"},o=a(`<h2 id="attach-free-ipv6-address-segments-to-host-machines" tabindex="-1">Attach free IPV6 address segments to host machines <a class="header-anchor" href="#attach-free-ipv6-address-segments-to-host-machines" aria-label="Permalink to &quot;Attach free IPV6 address segments to host machines&quot;">â€‹</a></h2><p>Some machines do not have an IPV6 /64 subnet, so here is a way to attach an IPV6 subnet for free.</p><p>Combined with the previous script that opens containers with IPV6 addresses, you can attach an IPV6 address to each container.</p><p>The disadvantage is that the address is rather dirty, cloudflare cdn may not be able to set up, self-testing</p><ol start="0"><li>Initial environment modification</li></ol><p>Execute:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">touch /etc/cloud/cloud-init.disabled</span></span></code></pre></div><p>Turn off the automated overwrite of cloud-init first, and then check what the machine uses to manage the network by running</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">systemctl is-active systemd-networkd</span></span></code></pre></div><p>and</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">systemctl is-active networking</span></span></code></pre></div><p>See which case it belongs to, if it&#39;s active in the former and inactive in the latter, you need to reinstall/DD a system that&#39;s not configured this way, or switch the local machine to use ifupdown to manage network execution</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;"># Judge for yourself if you need to disable the original network management.</span></span>
<span class="line"><span style="color:#A6ACCD;"># sudo systemctl stop systemd-networkd</span></span>
<span class="line"><span style="color:#A6ACCD;"># sudo systemctl disable systemd-networkd</span></span>
<span class="line"><span style="color:#A6ACCD;"># sudo systemctl stop systemd-networkd.socket</span></span>
<span class="line"><span style="color:#A6ACCD;"># sudo systemctl disable systemd-networkd.socket</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">sudo apt-get install ifupdown</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo systemctl start networking</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo systemctl enable networking</span></span></code></pre></div><p>Then reboot the server, check whether the machine&#39;s network will be rebooted due to the modification of the situation, and execute \`\`\`uptime\`\` to observe that the startup has been more than 1 minute before proceeding to the next step.</p><p>If it is inactive and active, there is no need to switch the network management program and you can proceed directly to the next step.</p><ol><li>Register for an account at <a href="https://tunnelbroker.net/" target="_blank" rel="noreferrer">https://tunnelbroker.net/</a> and click <code>Create Regular Tunnel</code> on the left.</li></ol><p><img src="https://github.com/oneclickvirt/oneclickvirt.github.io/assets/103393591/35923be5-821f-45c8-8401-962ea3f97726" alt="1"></p><ol start="2"><li>Fill in the red box with the IPV4 address of your server, choose a connection point that is close to the physical distance, for example, if the machine is in Los Angeles, choose a connection point on the west coast of the U.S., and then display the green box prompts, point <code>Create Tunnel</code> to create it!</li></ol><p><img src="https://github.com/oneclickvirt/oneclickvirt.github.io/assets/103393591/cab04113-4d6a-4d6f-9952-d3851057fc4a" alt="2"></p><p><img src="https://github.com/oneclickvirt/oneclickvirt.github.io/assets/103393591/518dc62a-c8d0-48e3-bb13-befc39348990" alt="3"></p><p><img src="https://github.com/oneclickvirt/oneclickvirt.github.io/assets/103393591/6188de3f-e83c-400e-9594-dd3f73aaf46a" alt="4"></p><ol start="3"><li>Wait for the following screen, click <code>Example Configurations</code> and select the corresponding system, for example, the host of LXD is definitely Debian/Ubuntu.</li></ol><p><img src="https://github.com/oneclickvirt/oneclickvirt.github.io/assets/103393591/9f0045fc-b1ac-4954-9ecd-1fba47d07d8a" alt="5"></p><p><img src="https://github.com/oneclickvirt/oneclickvirt.github.io/assets/103393591/2fb7c951-371c-452c-b775-78f69b980a2c" alt="6"></p><ol start="4"><li>The boxed part is the document to be modified and the content to be filled in.</li></ol><p><img src="https://github.com/oneclickvirt/oneclickvirt.github.io/assets/103393591/c0156902-b4c0-4001-823e-50f611215393" alt="7"></p><ol start="5"><li>Execute the following commands to append IPV6 settings to your network configuration file (or modify the <code>/etc/network/interfaces</code> file yourself with vim or vi commands to add them).</li></ol><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">sudo tee -a /etc/network/interfaces &lt;&lt;EOF</span></span>
<span class="line"><span style="color:#A6ACCD;"># Here, copy and paste the contents of the configuration file in the red box before, and then execute this command</span></span>
<span class="line"><span style="color:#A6ACCD;">EOF</span></span></code></pre></div><p>You can then use <code>cat /etc/network/interfaces</code> to see if the configuration file has been written properly</p><ol start="6"><li>If all of the above is okay, then you need to enable the network interface</li></ol><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">apt-get install net-tools iproute2 -y</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl restart networking</span></span></code></pre></div><ol start="7"><li>You can then test that the IPV6 network is attached.</li></ol><p>Execute the <code>ifconfig</code> command, at which point there should be a he-ipv6 interface, similar to the following:</p><p><img src="https://github.com/oneclickvirt/oneclickvirt.github.io/assets/103393591/1760af85-2b60-4352-ad8c-3c69e49fc1e4" alt="8"></p><p>Or execute:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">curl ipv6.ip.sb</span></span></code></pre></div><p>Return the IPV6 address you are bound to.</p><ol start="8"><li>Additional settings for NAT VPS</li></ol><p>IPv4 NAT VPS may require some additional settings beyond the IP replacement operation mentioned earlier, otherwise it may still not be able to access the IPv6 network.</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">apt-get install ufw -y</span></span>
<span class="line"><span style="color:#A6ACCD;">ufw allow 41</span></span></code></pre></div><p>Add relevant routing rules</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">route -A inet6 add ::/0 dev he-ipv6</span></span></code></pre></div><ol start="9"><li>If you don&#39;t need the IPV6 network anymore and want to delete it, delete the he-ipv6 network interface configuration.</li></ol><p>Delete the he-ipv6 network interface configuration (if not deleted it will be enabled automatically after reboot), remember to modify the <code>/etc/network/interfaces</code> file and delete the content added in the red box before.</p><p>Then reboot the server to remove the</p>`,45),i=[o];function l(c,r,p,d,h,u){return t(),s("div",null,i)}const f=e(n,[["render",l]]);export{g as __pageData,f as default};
