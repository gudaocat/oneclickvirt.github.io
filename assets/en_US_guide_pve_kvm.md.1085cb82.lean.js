import{_ as s,v as a,b as l,R as t}from"./chunks/framework.70afa331.js";const A=JSON.parse('{"title":"KVM虚拟化","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"en_US/guide/pve_kvm.md","filePath":"en_US/guide/pve_kvm.md","lastUpdated":1692191441000}'),n={name:"en_US/guide/pve_kvm.md"},o=t(`<h1 id="kvm虚拟化" tabindex="-1">KVM虚拟化 <a class="header-anchor" href="#kvm虚拟化" aria-label="Permalink to &quot;KVM虚拟化&quot;">​</a></h1><h2 id="ssh登录说明" tabindex="-1">SSH登录说明 <a class="header-anchor" href="#ssh登录说明" aria-label="Permalink to &quot;SSH登录说明&quot;">​</a></h2><p>The virtual machines created through KVM virtualization do not have the username&#39;&#39;&#39;root&#39;&#39;&#39;by default. To switch to the root user, you need to execute&#39;&#39;&#39;sudo -i&#39;&#39;&#39;.</p><p><strong>Of course, some templates actually allow logging in with the username <code>root</code>, and the default root password is <code>password</code>. You can give it a try.</strong></p><p>Once you&#39;ve logged in via SSH and switched to root privileges, it&#39;s crucial to change the root password. You can use the following command to do so.</p><p>Command:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">bash</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;(</span><span style="color:#FFCB6B;">curl</span><span style="color:#C3E88D;"> -sSL https://raw.githubusercontent.com/fscarmen/tools/main/root.sh</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> [PASSWORD]</span></span></code></pre></div><h2 id="partial-notes" tabindex="-1">Partial Notes <a class="header-anchor" href="#partial-notes" aria-label="Permalink to &quot;Partial Notes&quot;">​</a></h2><p><strong>Commands to set up the testing environment for executing this project are as follows:</strong></p><p><img src="https://github.com/oneclickvirt/oneclickvirt.github.io/blob/main/docs/images/pve_kvm/pve_kvm_1.png?raw=true" alt="图片"></p><p>To perform the above-mentioned query, you only need to use the one-click script below to automatically create a virtual machine. There is no need to manually modify settings on the web interface.</p><p><img src="https://github.com/oneclickvirt/oneclickvirt.github.io/blob/main/docs/images/pve_kvm/pve_kvm_2.png?raw=true" alt="图片"></p><p>After creating the virtual machines using the subsequent script as mentioned above, it <strong>may</strong> be necessary to manually modify the settings on the web interface. You will need to disable hardware nested virtualization for each respective virtual machine, as shown in the following diagram.</p><p><img src="https://github.com/oneclickvirt/oneclickvirt.github.io/blob/main/docs/images/pve_kvm/pve_kvm_3.png?raw=true" alt="图片"></p><p>Stop the virtual machine before making modifications. After the modifications are done, you can start the machine to use NOVNC. Failure to close it <strong>may</strong> result in bugs that render this virtual machine unusable.</p><p>If you forcibly install PVE to enable KVM, even if the startup fails, you can also disable this option and try to start the virtual machine to see if it works.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Please use the &quot;screen&quot; command to suspend execution before launching the virtual machine, in order to avoid prolonged startup times. Unstable SSH connections could lead to interruptions during the intermediate execution.</p></div><h2 id="images-available-for-creating-kvm-virtual-machines" tabindex="-1">Images available for creating KVM virtual machines <a class="header-anchor" href="#images-available-for-creating-kvm-virtual-machines" aria-label="Permalink to &quot;Images available for creating KVM virtual machines&quot;">​</a></h2><ul><li>Pre-installed with cloud-init enabled.</li><li>Enabled SSH login.</li><li>Pre-configured SSH to listen on ports 22 for both IPv4 and IPv6.</li><li>Enabled password authentication for login.</li><li>Enabled root login.</li><li>Partially pre-installed QEMU guest agent.</li></ul><p>The list of currently available image names is as follows:</p><p><a href="https://github.com/oneclickvirt/kvm_images/blob/main/list.text" target="_blank" rel="noreferrer">https://github.com/oneclickvirt/kvm_images/blob/main/list.text</a></p><h2 id="virtual-machines-with-standalone-nat-configuration-in-kvm-virtualization" tabindex="-1">Virtual machines with standalone NAT configuration in KVM virtualization. <a class="header-anchor" href="#virtual-machines-with-standalone-nat-configuration-in-kvm-virtualization" aria-label="Permalink to &quot;Virtual machines with standalone NAT configuration in KVM virtualization.&quot;">​</a></h2><ul><li>Automatically deploy NAT servers with the default Debian 10 image, chosen for its minimal footprint.</li><li>It&#39;s possible to customize the image used through the command, and pre-configured images are available. These images come with storage settings ranging from 2 to 10 GB of disk space. For regular use, <strong>at least 10 GB</strong> of disk space is recommended. You can increase the disk size if certain images fail to start.</li><li>The command allows for specifying the storage disk location. When not specified, it defaults to the local disk, which is the system disk. It can also be set to a mount disk as displayed in PVE.</li><li>Recommended custom memory size is 512 MB.</li><li>Automatic internal and external port mapping, including ports 22, 80, 443, and 25 other port numbers shared between internal and external networks.</li><li>After generation, there&#39;s a wait time for the virtual machine&#39;s internal cloud-init configuration to establish network and login information. This process takes approximately 5 minutes.</li><li>Pertinent virtual machine information will be stored in the NOTES section of the corresponding VM on the web interface, accessible for viewing through the web portal.</li><li>If the host machine has an IPV6 subnet, IPV6 networking will be automatically added. However, there won&#39;t be any public IPV6 addresses.</li></ul><p>Command:</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">curl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-L</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://raw.githubusercontent.com/spiritLHLS/pve/main/scripts/buildvm.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-o</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">buildvm.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">chmod</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">+x</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">buildvm.sh</span></span></code></pre></div><h3 id="usage-instructions" tabindex="-1">Usage Instructions <a class="header-anchor" href="#usage-instructions" aria-label="Permalink to &quot;Usage Instructions&quot;">​</a></h3><ul><li>System Support:</li><li>For x86_64 architecture systems listed in <a href="https://github.com/oneclickvirt/kvm_images/releases/tag/v1.0" target="_blank" rel="noreferrer">this link</a>, simply use the filename without the .qcow2 extension when using.</li><li>For arm architecture systems listed at <a href="http://cloud-images.ubuntu.com/" target="_blank" rel="noreferrer">this link</a>, use the system name and version number, such as ubuntu20 or ubuntu22.</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Note that usernames consisting of only numbers may cause issues with cloud-init. It&#39;s preferable to use usernames that are entirely in English or start with an English character.</p></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">./buildvm.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">VMID</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Username</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Password</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Number_of_CPU_Cores</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Memory</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Disk</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">SSH_Port</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Port_80</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Port_443</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Public_Port_Start</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Public_Port_End</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">System</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Storage_Disk</span></span></code></pre></div><h3 id="test-example" tabindex="-1">Test Example <a class="header-anchor" href="#test-example" aria-label="Permalink to &quot;Test Example&quot;">​</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">./buildvm.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">102</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">test1</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">oneclick123</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">512</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">40001</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">40002</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">40003</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">50000</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">50025</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">debian11</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">local</span></span></code></pre></div><p>After setup is completed, you can execute <code>cat vm102</code> to view the information or check the NOTES section for the corresponding VM on the WEB interface.</p><p>Below is the information for the example VM that has been set up:</p><table><thead><tr><th>Attribute</th><th>Value</th></tr></thead><tbody><tr><td>VMID</td><td>102</td></tr><tr><td>SSH Username</td><td>test1</td></tr><tr><td>SSH Password</td><td>oneclick123</td></tr><tr><td>Number of CPU Cores</td><td>1</td></tr><tr><td>Memory Size</td><td>512MB</td></tr><tr><td>Disk Size</td><td>10G</td></tr><tr><td>SSH Port</td><td>40001</td></tr><tr><td>Port 80</td><td>40002</td></tr><tr><td>Port 443</td><td>40003</td></tr><tr><td>Port Range for NAT</td><td>50000 to 50025</td></tr><tr><td>Operating System</td><td>debian11</td></tr><tr><td>Host Storage Disk</td><td>local</td></tr></tbody></table><h3 id="删除示例" tabindex="-1">删除示例 <a class="header-anchor" href="#删除示例" aria-label="Permalink to &quot;删除示例&quot;">​</a></h3><ul><li>停止VM</li><li>删除VM</li><li>删除端口映射</li><li>重启网络</li><li>删除log文件</li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">qm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">stop</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">102</span></span>
<span class="line"><span style="color:#FFCB6B;">qm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">destroy</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">102</span></span>
<span class="line"><span style="color:#FFCB6B;">iptables</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-t</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nat</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-F</span></span>
<span class="line"><span style="color:#FFCB6B;">iptables</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-t</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">filter</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-F</span></span>
<span class="line"><span style="color:#FFCB6B;">service</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">networking</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">restart</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">restart</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">networking.service</span></span>
<span class="line"><span style="color:#FFCB6B;">rm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-rf</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">vm102</span></span></code></pre></div><h2 id="批量开设nat的kvm虚拟化的虚拟机" tabindex="-1">批量开设NAT的KVM虚拟化的虚拟机 <a class="header-anchor" href="#批量开设nat的kvm虚拟化的虚拟机" aria-label="Permalink to &quot;批量开设NAT的KVM虚拟化的虚拟机&quot;">​</a></h2><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>初次使用前需要保证当前PVE纯净且宿主机未进行过任何端口映射，否则设置冲突可能出现BUG</p></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>开设前请使用screen挂起执行，避免批量开设时间过长，SSH不稳定导致中间执行中断</p></div><ul><li>可多次运行批量生成VM</li><li>自动开设NAT服务器，选项留空默认使用debian11镜像，可自定义使用镜像名字，支持的系统名字详见上文支持的镜像列表</li><li>自动进行内外网端口映射，含22，80，443端口以及其他25个内外网端口号一样的端口</li><li>生成后需要等待一段时间虚拟机内部的cloudinit配置好网络以及登陆信息，大概需要5分钟，每个虚拟机创建之间有间隔等待60秒避免突发性能不足</li><li>默认批量开设的虚拟机网络配置为：22，80，443端口及一个25个端口区间的内外网映射</li><li>可自定义批量开设的核心数，内存大小，硬盘大小，使用宿主机哪个存储盘，记得自己计算好空闲资源开设</li><li>虚拟机的相关信息将会存储到WEB端对应VM的NOTES中，可在WEB端查看</li><li>如果宿主机自带IPV6子网将自动附加上IPV6网络，但无公网IPV6地址</li></ul><p>Command:</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">curl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-L</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://raw.githubusercontent.com/spiritLHLS/pve/main/scripts/create_vm.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-o</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">create_vm.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">chmod</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">+x</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">create_vm.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">bash</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">create_vm.sh</span></span></code></pre></div><p>开设完毕可执行<code>cat vmlog</code>查看信息，或到WEB端对应VM的NOTES中查看</p><h2 id="删除所有虚拟机" tabindex="-1">删除所有虚拟机 <a class="header-anchor" href="#删除所有虚拟机" aria-label="Permalink to &quot;删除所有虚拟机&quot;">​</a></h2><ul><li>删除所有VM</li><li>删除所有nat的端口映射</li><li>重启网络</li><li>删除log文件</li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> vmid </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$(</span><span style="color:#FFCB6B;">qm</span><span style="color:#C3E88D;"> list </span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;"> </span><span style="color:#FFCB6B;">awk</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{if(NR&gt;1) print $1}</span><span style="color:#89DDFF;">&#39;)</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">do</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">qm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">stop</span><span style="color:#A6ACCD;"> $vmid</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">qm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">destroy</span><span style="color:#A6ACCD;"> $vmid</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">rm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-rf</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/var/lib/vz/images/</span><span style="color:#A6ACCD;">$vmid</span><span style="color:#A6ACCD;">*</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">done</span></span>
<span class="line"><span style="color:#FFCB6B;">iptables</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-t</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nat</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-F</span></span>
<span class="line"><span style="color:#FFCB6B;">iptables</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-t</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">filter</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-F</span></span>
<span class="line"><span style="color:#FFCB6B;">service</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">networking</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">restart</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">restart</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">networking.service</span></span>
<span class="line"><span style="color:#FFCB6B;">rm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-rf</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">vmlog</span></span>
<span class="line"><span style="color:#FFCB6B;">rm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-rf</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">vm</span><span style="color:#A6ACCD;">*</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>PVE修改VM配置前都得停机先，再修改配置，修改完再启动，免得出现配置重载错误</p></div><h2 id="开设独立ipv4地址的虚拟机" tabindex="-1">开设独立IPV4地址的虚拟机 <a class="header-anchor" href="#开设独立ipv4地址的虚拟机" aria-label="Permalink to &quot;开设独立IPV4地址的虚拟机&quot;">​</a></h2><p>两个版本，各取所需</p><h3 id="自动选择ipv4地址无需手动指定的版本" tabindex="-1">自动选择IPV4地址无需手动指定的版本 <a class="header-anchor" href="#自动选择ipv4地址无需手动指定的版本" aria-label="Permalink to &quot;自动选择IPV4地址无需手动指定的版本&quot;">​</a></h3><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>使用前需要保证当前宿主机的IP段带了至少2个IP，且有空余的IP未配置，该空余的IP未绑定宿主机</p></div><ul><li>自动检测可用的IP区间，通过ping检测空余可使用的IP，选取其中之一绑定到虚拟机上</li><li>如果宿主机自带IPV6子网将可选择是否附加上IPV6地址</li><li>系统的相关信息将会存储到对应的虚拟机的NOTE中，可在WEB端查看</li></ul><p>Command:</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">curl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-L</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://raw.githubusercontent.com/spiritLHLS/pve/main/scripts/buildvm_extraip.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-o</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">buildvm_extraip.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">chmod</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">+x</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">buildvm_extraip.sh</span></span></code></pre></div><h4 id="创建示例" tabindex="-1">创建示例 <a class="header-anchor" href="#创建示例" aria-label="Permalink to &quot;创建示例&quot;">​</a></h4><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">./buildvm_extraip.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">VMID</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">用户名</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">密码</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">CPU核数</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">内存大小以MB计算</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">硬盘大小以GB计算</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">系统</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">存储盘</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">是否附加IPV6</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">默认为N</span><span style="color:#89DDFF;">)</span></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">./buildvm_extraip.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">152</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">test1</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">oneclick123</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1024</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">debian12</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">local</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">N</span></span></code></pre></div><p>上述命令意义为开设一个带独立IPV4地址的虚拟机</p><table><thead><tr><th>属性</th><th>值</th></tr></thead><tbody><tr><td>VMID</td><td>152</td></tr><tr><td>用户名</td><td>test1</td></tr><tr><td>密码</td><td>oneclick123</td></tr><tr><td>CPU</td><td>1核</td></tr><tr><td>内存</td><td>1024MB</td></tr><tr><td>硬盘</td><td>10G</td></tr><tr><td>系统</td><td>debian12</td></tr><tr><td>存储盘</td><td>local盘</td></tr><tr><td>IPV6附加</td><td>默认不附加</td></tr></tbody></table><h3 id="需要手动指定ipv4地址的版本" tabindex="-1">需要手动指定IPV4地址的版本 <a class="header-anchor" href="#需要手动指定ipv4地址的版本" aria-label="Permalink to &quot;需要手动指定IPV4地址的版本&quot;">​</a></h3><ul><li>需要手动在命令中指定IPV4地址，且带上子网长度</li><li>如果宿主机自带IPV6子网将可选择是否附加上IPV6地址</li><li>如果商家有给IPV4地址和子网长度，请仔细比对，按照下面示例的命令写参数</li><li>系统的相关信息将会存储到对应的虚拟机的NOTE中，可在WEB端查看</li></ul><p>Command:</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">curl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-L</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://raw.githubusercontent.com/spiritLHLS/pve/main/scripts/buildvm_manual_ip.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-o</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">buildvm_manual_ip.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">chmod</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">+x</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">buildvm_manual_ip.sh</span></span></code></pre></div><h4 id="创建示例-1" tabindex="-1">创建示例 <a class="header-anchor" href="#创建示例-1" aria-label="Permalink to &quot;创建示例&quot;">​</a></h4><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">./buildvm_manual_ip.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">VMID</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">用户名</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">密码</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">CPU核数</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">内存大小以MB计算</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">硬盘大小以GB计算</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">系统</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">存储盘</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">IPV4地址</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">是否附加IPV6</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">默认为N</span><span style="color:#89DDFF;">)</span></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">./buildvm_manual_ip.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">152</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">test1</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">oneclick123</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1024</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">debian12</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">local</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">a.b.c.d/24</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">N</span></span></code></pre></div><p>上述命令意义为开设一个带独立IPV4地址的虚拟机</p><table><thead><tr><th>属性</th><th>值</th></tr></thead><tbody><tr><td>VMID</td><td>152</td></tr><tr><td>用户名</td><td>test1</td></tr><tr><td>密码</td><td>oneclick123</td></tr><tr><td>CPU</td><td>1核</td></tr><tr><td>内存</td><td>1024MB</td></tr><tr><td>硬盘</td><td>10G</td></tr><tr><td>系统</td><td>debian12</td></tr><tr><td>存储盘</td><td>local盘 (系统盘)</td></tr><tr><td>IPV4地址</td><td>a.b.c.d</td></tr><tr><td>子网</td><td>/24 子网</td></tr><tr><td>IPV6</td><td>无</td></tr></tbody></table><h2 id="开设纯ipv6地址的虚拟机" tabindex="-1">开设纯IPV6地址的虚拟机 <a class="header-anchor" href="#开设纯ipv6地址的虚拟机" aria-label="Permalink to &quot;开设纯IPV6地址的虚拟机&quot;">​</a></h2><p>前提是宿主机给的是IPV6子网而不是单独一个IPV6地址，且宿主机未开启MAC地址校验</p><h3 id="自动选择ipv6地址无需手动指定" tabindex="-1">自动选择IPV6地址无需手动指定 <a class="header-anchor" href="#自动选择ipv6地址无需手动指定" aria-label="Permalink to &quot;自动选择IPV6地址无需手动指定&quot;">​</a></h3><ul><li>自动检测可用的IPV6区间，对应虚拟机编号的V6地址绑定到虚拟机上</li><li>系统的相关信息将会存储到对应的虚拟机的NOTE中，可在WEB端查看</li></ul><p>Command:</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">curl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-L</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://raw.githubusercontent.com/spiritLHLS/pve/main/scripts/buildvm_onlyv6.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-o</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">buildvm_onlyv6.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">chmod</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">+x</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">buildvm_onlyv6.sh</span></span></code></pre></div><h4 id="创建示例-2" tabindex="-1">创建示例 <a class="header-anchor" href="#创建示例-2" aria-label="Permalink to &quot;创建示例&quot;">​</a></h4><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">./buildvm_onlyv6.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">VMID</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">用户名</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">密码</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">CPU核数</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">内存大小以MB计算</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">硬盘大小以GB计算</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">系统</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">存储盘</span></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">./buildvm_onlyv6.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">152</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">test1</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">oneclick123</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1024</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">debian12</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">local</span></span></code></pre></div><p>上述命令意义为开设一个纯IPV6地址的虚拟机</p><table><thead><tr><th>参数</th><th>值</th></tr></thead><tbody><tr><td>VMID</td><td>152</td></tr><tr><td>用户名</td><td>test1</td></tr><tr><td>密码</td><td>oneclick123</td></tr><tr><td>CPU</td><td>1核</td></tr><tr><td>内存</td><td>1024MB</td></tr><tr><td>硬盘</td><td>10G</td></tr><tr><td>系统</td><td>debian12</td></tr><tr><td>存储盘</td><td>local</td></tr></tbody></table><h2 id="删除vm152示例" tabindex="-1">删除vm152示例 <a class="header-anchor" href="#删除vm152示例" aria-label="Permalink to &quot;删除vm152示例&quot;">​</a></h2><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">qm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">stop</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">152</span></span>
<span class="line"><span style="color:#FFCB6B;">qm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">destroy</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">152</span></span>
<span class="line"><span style="color:#FFCB6B;">rm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-rf</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">vm152</span></span></code></pre></div>`,82),e=[o];function p(r,c,i,C,d,y){return a(),l("div",null,e)}const D=s(n,[["render",p]]);export{A as __pageData,D as default};
